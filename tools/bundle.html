<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Repository Bundler</title>
  <style>
    :root{
      --ink:#0b1320;--muted:#617387;--line:#e1e6eb;--bg:#f7fafc;--brand:#1e6091;--ok:#2f9e44;--warn:#c92a2a;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;background:var(--bg);color:var(--ink)}
    .wrap{max-width:980px;margin:24px auto;padding:16px}
    .card{background:#fff;border:1px solid var(--line);border-radius:12px;padding:16px}
    h1{margin:0 0 6px 0;font-size:22px}
    .muted{color:var(--muted);font-size:12px}
    .grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    input[type="text"],input[type="password"],textarea,select{
      border:1px solid #d8dee6;border-radius:8px;padding:8px;font-size:14px;width:100%;
    }
    textarea{height:260px;font-family:ui-monospace,SFMono-Regular,Menlo,monospace;white-space:pre}
    button{border:1px solid var(--line);border-radius:8px;background:#fff;padding:8px 12px;cursor:pointer}
    button.primary{background:var(--brand);color:#fff;border-color:var(--brand)}
    button.ghost{background:transparent}
    button:disabled{opacity:.6;cursor:not-allowed}
    .btns{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    #status{margin-left:4px}
    .ok{color:var(--ok)} .warn{color:var(--warn)}
    details{margin-top:12px}
    pre{white-space:pre-wrap}
    .progress-row{display:flex;gap:12px;align-items:center;margin:10px 0}
    progress{width:280px;height:12px}
    .mini{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Repository Bundler</h1>
      <p class="muted">Create a single JSON (and optional ZIP) snapshot of a GitHub repository — text files as UTF-8, binaries as Base64. Runs client-side only.</p>

      <div class="grid-3" style="margin-top:8px">
        <label>Owner
          <input id="owner" type="text" placeholder="marcleguyader">
        </label>
        <label>Repository
          <input id="repo" type="text" placeholder="CRM">
        </label>
        <label>Branch (leave empty for auto-detect)
          <input id="branch" type="text" placeholder="(auto)">
        </label>
      </div>

      <div class="grid-3" style="margin-top:8px">
        <label>GitHub Token (optional, avoids rate limit)
          <input id="token" type="password" placeholder="ghp_… (contents:read)">
        </label>
        <div></div><div></div>
      </div>

      <div class="progress-row">
        <progress id="prog" max="100" value="0"></progress>
        <span id="prog-text" class="mini">0 / 0</span>
      </div>

      <div class="btns" style="margin:10px 0">
        <button id="btn-gen" class="primary">Generate snapshot</button>
        <button id="btn-copy" class="ghost" disabled>Copy JSON</button>
        <button id="btn-dl-json" disabled>Download JSON</button>
        <button id="btn-dl-zip" disabled>Download ZIP</button>
        <span id="status" class="muted">Ready.</span>
      </div>

      <textarea id="out" placeholder='The JSON bundle will appear here…' readonly></textarea>

      <details>
        <summary><b>Debug log</b></summary>
        <pre id="log"></pre>
      </details>
    </div>
  </div>

  <!-- JSZip for ZIP export -->
  <script defer src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
  <script type="module" src="./bundle.js"></script>
</body>
</html>
